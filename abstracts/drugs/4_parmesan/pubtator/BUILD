zcat ../../../../ground_truth/pubtator/genes/gene2pubtatorcentral.gz | cut -f1,3,4 | sort -k1,1 | join -t$'\t' - <(cat ../summaries.txt | cut -f1 | sort -u) | awk 'BEGIN {FS = "\t"} $3 != "" && $2 != "None"' | sed 's/|/\t/g' | awk 'BEGIN {FS = "\t"} {for(i = 3; i <= NF; i++){print $1 "\t" $2 "\t" $3}}' | awk 'BEGIN {FS = "\t"} {gsub(";", "\t", $2); print $1 "\t" $3 "\t" $2}' | awk 'BEGIN {FS = "\t"} {for(i = 3; i <= NF; i++){print $1 "\t" $i "\t" $2}}' | sort -u > relevant_pubtator_genes.txt
zcat ../../../../ground_truth/pubtator/chemicals/chemical2pubtatorcentral.gz | cut -f1,3,4 | sort -k1,1 | join -t$'\t' - <(cat ../summaries.txt | cut -f1 | sort -u) | awk 'BEGIN {FS = "\t"} $3 != "" && $2 != "None"' | sed 's/|/\t/g' | awk 'BEGIN {FS = "\t"} {for(i = 3; i <= NF; i++){print $1 "\t" $2 "\t" $3}}' | awk 'BEGIN {FS = "\t"} {gsub(";", "\t", $2); print $1 "\t" $3 "\t" $2}' | awk 'BEGIN {FS = "\t"} {for(i = 3; i <= NF; i++){print $1 "\t" $i "\t" $2}}' | sort -u > relevant_pubtator_drugs.txt

cat ../summaries.txt | awk 'BEGIN {FS = "\t"} {print $1 "_" tolower($2) "\t" $1 "_" tolower($5) "\t" $0}' | sort -t$'\t' -k1,1 | join -a 1 -o auto -t$'\t' - <(cat relevant_pubtator_drugs.txt | awk 'BEGIN {FS = "\t"} {print $1 "_" tolower($3) "\t" $2}' | sort -t$'\t' -k1,1) | sort -t$'\t' -k2,2 | join -a 1 -o auto -t$'\t' -1 2 -2 1 - <(cat relevant_pubtator_genes.txt | awk 'BEGIN {FS = "\t"} {print $1 "_" tolower($3) "\t" $2}' | sort -t$'\t' -k1,1) | cut -f3- | awk 'BEGIN {FS = "\t"} $8 != "-"' > summaries_pubtator_entrez.txt

cat ../summaries.txt | awk 'BEGIN {FS = "\t"} {key = tolower($2); gsub(" ", "", key); gsub("-", "", key); gsub(";", "", key); gsub(",", "", key); print key "\t" $0}' | awk 'BEGIN {FS = "\t"} $1 != ""' | sort -t$'\t' -k1,1 | join -t$'\t' - <(cat ../../../../mappings/pubchem/filtered_id_maps.txt | sort -t$'\t' -k1,1) | cut -f2- | awk 'BEGIN {FS = "\t"} {print $1 "_" $5 "\t" $0}' | sort -t$'\t' -k1,1 | join -t$'\t' - <(cat relevant_pubtator_genes.txt | awk 'BEGIN {FS = "\t"} {print $1 "_" $3 "\t" $2}' | sort -t$'\t' -k1,1) | cut -f2- | sort -u > summaries_pubtator_pubchem_entrez.txt

